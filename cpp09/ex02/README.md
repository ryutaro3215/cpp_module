# Implement "Merge Insertion Sort"

## What is this sort ?

This sort is comparison sorting algorithm which has fewer comparison.

## The structure of algorithm

Merge-insertion sort は、入力
$X$（要素数 $n$）に対して次の手順を実行します\[6]。

1. 要素 $X$ を $\lfloor n/2 \rfloor$ 個のペアに分けます（偶数個にならない場合は 1 要素余る）。
2. 各ペアごとに比較を 1 回行い、2 要素のうち大きい方を決定します（比較回数は $\lfloor n/2 \rfloor$ 回）。
3. 各ペアから得られた大きい方の要素 $\lfloor n/2 \rfloor$ 個を、再帰的に merge-insertion sort でソートして、昇順に並んだ列 $S$ を作ります。
4. $S$ の最初（最小要素）とペアになっていたもう一方の要素を、$S$ の先頭に挿入します。
5. 残りの $\lceil n/2 \rceil - 1$ 個の要素（＝ $X \setminus S$）を、特別に選ばれた挿入順序（後述）で $S$ に 1 つずつ挿入します。各挿入では $S$ の部分列に対して二分探索（後述）を用い、挿入位置を決定します。

このアルゴリズムは、挿入のための二分探索を行う際に、探索対象の部分列の長さが「2 のべき乗 − 1」のときに最も効率的になる（最悪の場合の比較回数という観点から）という事実を利用しています。
この長さでは、探索結果のどの場合でも比較回数が同じになるためです\[1]。

この性質を利用するため、要素を挿入する順序は、このような長さの部分列になるように選びます。具体的には、上記手順のステップ 4（残りの要素を挿入する前）の時点での $S$ を考え、昇順に並んだ $S$ の $i$ 番目の要素を $x_i$ とします。

挿入の順序を最適化することによって、最小比較回数を達成することができるようになっている。
